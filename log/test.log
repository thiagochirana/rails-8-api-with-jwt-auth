[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35mSQL (0.0ms)[0m  [1m[35mSET search_path TO public[0m
  [1m[35m (23.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "streampix_app_test"[0m
  [1m[35m (23.2ms)[0m  [1m[35mCREATE DATABASE "streampix_app_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (10.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql" SCHEMA pg_catalog[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "tokens" CASCADE[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE TABLE "tokens" ("id" bigserial primary key, "user_id" bigint NOT NULL, "jti" character varying NOT NULL, "jwt" character varying NOT NULL, "token_type" character varying NOT NULL, "expires_at" timestamp(6) NOT NULL, "revoked" boolean DEFAULT FALSE, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_tokens_on_jti" ON "tokens" ("jti")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_tokens_on_jwt" ON "tokens" ("jwt")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE INDEX "index_tokens_on_user_id" ON "tokens" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (2.5ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "nickname" character varying, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_nickname" ON "users" ("nickname")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "tokens" ADD CONSTRAINT "fk_rails_ac8a5d0441"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20241215211259)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20241215204835);[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2024-12-15 21:42:41.329799', '2024-12-15 21:42:41.329833') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '6ff6c365ecaa0fcf1e16c4a903f7cada215c8089', '2024-12-15 21:42:41.334179', '2024-12-15 21:42:41.334180') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$OExl6v0gxfruG16ElE4mVO8xosCpLLTfzo4Z6ykhJO352z5UYMgdy', '2024-12-15 21:42:41.785166', '2024-12-15 21:42:41.785166')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:42:41.930958"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:42:41.941670"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:42:41.950608"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:42:41.956933"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
UserTest: test_should_not_allow_password_with_spaces
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------
UserTest: test_should_not_allow_password_with_accents_or_special_characters
---------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
UserTest: test_should_not_authenticate_user_with_incorrect_password
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------
UserTest: test_should_authenticate_user_with_correct_password
-------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$Whyc2vQWz4DiHFDYBZILs.cio/4DncM4WyXPzhuBWisOmLBnLyqyG', '2024-12-15 21:44:16.217999', '2024-12-15 21:44:16.217999')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------
UserTest: test_should_not_allow_password_with_accents_or_special_characters
---------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
UserTest: test_should_not_authenticate_user_with_incorrect_password
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
UserTest: test_should_not_allow_password_with_spaces
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------
UserTest: test_should_authenticate_user_with_correct_password
-------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (2.0ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:44:16.384679"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:44:16.397944"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:44:16.412810"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:44:16.418658"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$wjgF.NzFl5X3K.6FzJspeuxbXMv7ec8/U95kddf3sh9WUfz71FGXy', '2024-12-15 21:46:16.421265', '2024-12-15 21:46:16.421265')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:16.554873"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:16.564390"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:16.575570"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:16.582516"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$C4mimWCWhKwDMvZ5LofREORYwJw6ATRheZ1Jo1aiV.Q/MiK4Cql0u', '2024-12-15 21:46:53.952297', '2024-12-15 21:46:53.952297')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
UserTest: test_should_not_allow_password_with_spaces
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------
UserTest: test_should_not_allow_password_with_accents_or_special_characters
---------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------
UserTest: test_should_authenticate_user_with_correct_password
-------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
UserTest: test_should_not_authenticate_user_with_incorrect_password
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:54.128432"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:54.144049"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:54.149563"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:46:54.158678"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$N50zRI16hYjwh4YQlwY/nORHjPy2esvucc0GiLqaLldiXKaUxE.fC', '2024-12-15 21:48:08.812369', '2024-12-15 21:48:08.812369')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:48:08.945822"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:48:08.957102"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:48:08.967196"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:48:08.972767"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
UserTest: test_should_not_authenticate_user_with_incorrect_password
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------
UserTest: test_should_not_allow_password_with_accents_or_special_characters
---------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
UserTest: test_should_not_allow_password_with_spaces
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------
UserTest: test_should_authenticate_user_with_correct_password
-------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$X/h19WK9WhMZIutGrbEGr.BvguRlmPrD6tiJDRo4wSNX.hQ1GpZvS', '2024-12-15 21:48:50.728322', '2024-12-15 21:48:50.728322')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$pVok4iQ2jg/.QcYsgODCPOGibauMI559YP8..H2n4sT13JTLpD1p2', '2024-12-15 21:51:28.022903', '2024-12-15 21:51:28.022903')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:51:28 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 8ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$.afPD5Wf.M0SCcHJBi/Fh.UyPbYcof/Pvo1NzJ4mWAmYdvJZyzLgu', '2024-12-15 21:51:44.427982', '2024-12-15 21:51:44.427982')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:51:44 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 8ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$136L6eMR0wg4TvxHpW5FB.y0Ki1wiRWy3bgShn5nrQN7i8Qi9pWOu', '2024-12-15 21:53:41.391916', '2024-12-15 21:53:41.391916')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:53:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 8ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$Iyg66Ow/EOSbzZX9CeO8ju5UOZe5BAPWzLc/fT4JxW68hg1V6K36a', '2024-12-15 21:54:26.904105', '2024-12-15 21:54:26.904105')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:54:27 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:54:27 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$egkIqBnJKgwuy1coeqb37eI4CftE6klZyBYGujI04tOEoLtWMiYgm', '2024-12-15 21:55:15.525651', '2024-12-15 21:55:15.525651')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:55:15 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:55:43 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$2cVj4jOzEtAc0RpmzHxk7uCtzpu31RqVqXSSDBZDe4yqdsgq9qUTO', '2024-12-15 21:55:51.636800', '2024-12-15 21:55:51.636800')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:55:51 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 8ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:55:51 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$GG4sOlCUGJy18WefHHEYIuMRwwaWpRV1SKrm2z4wGFQbPLMSFBpBW', '2024-12-15 21:56:29.598622', '2024-12-15 21:56:29.598622')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:56:29 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 8ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:56:55 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$4B1Z.aU3HrUuBAT/L2wxBeWJ9ABFmol/o7a7a.In1rW2MWpHLFCfy', '2024-12-15 21:57:34.570210', '2024-12-15 21:57:34.570210')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:57:34 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
Completed 401 Unauthorized in 183ms (Views: 0.3ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:57:36 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$EH7bnOUq44SZKCgNmvFsZ.r2HWcrXpHPqOgSmc/FuvhZBK5u4nV.W', '2024-12-15 21:57:50.319195', '2024-12-15 21:57:50.319195')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:57:50 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
Completed 401 Unauthorized in 179ms (Views: 0.3ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:58:33 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$WL7QzDmEDUdYkBrJFxncj.ABnYUhLBDFHdd2kwp9C39eLEscflpbW', '2024-12-15 21:59:24.507910', '2024-12-15 21:59:24.507910')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:59:24 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
Completed 401 Unauthorized in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:59:24 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$wBE8RBUMehmNm8j1W5iT2u1qNPLAMLsCqVovs3/AWEGkR2GWzFtu6', '2024-12-15 21:59:47.723390', '2024-12-15 21:59:47.723390')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:59:47 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:59:48.070852"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "026a9ddf-88e9-4e2f-b252-3bc571b4a3a2"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMTY4OCwianRpIjoiMDI2YTlkZGYtODhlOS00ZTJmLWIyNTItM2JjNTcxYjRhM2EyIn0.KKfUC7juTCH7plcn684ZUeT_FTuBGi1G0mQTUpuuRlg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:14:48.058637"], ["revoked", false], ["created_at", "2024-12-15 21:59:48.079228"], ["updated_at", "2024-12-15 21:59:48.079228"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:59:48.088230"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.0ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "9453b2c0-059b-411a-8d30-e20097a579a3"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4MzU4OCwianRpIjoiOTQ1M2IyYzAtMDU5Yi00MTFhLThkMzAtZTIwMDk3YTU3OWEzIn0.80kRihXNXD_obCrvIhAmhwuVRAFDM8rzUNErjo550-0"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 21:59:48.087616"], ["revoked", false], ["created_at", "2024-12-15 21:59:48.090875"], ["updated_at", "2024-12-15 21:59:48.090875"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 224ms (Views: 0.2ms | ActiveRecord: 5.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 21:59:48 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$HlouIzugQDqwEVLVj2A1Z.N1Ru0SQkkWIhTILI6pAQQxsr9TJJnkS', '2024-12-15 21:59:59.111318', '2024-12-15 21:59:59.111318')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 21:59:59 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:59:59.451689"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "f7f97bc0-b212-4359-ad41-0b95e8840297"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMTY5OSwianRpIjoiZjdmOTdiYzAtYjIxMi00MzU5LWFkNDEtMGI5NWU4ODQwMjk3In0.3WPH7o9G4dXCF7NQr3zbLfNgTsMV-wCKgwT9GYNQcbY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:14:59.439470"], ["revoked", false], ["created_at", "2024-12-15 21:59:59.460189"], ["updated_at", "2024-12-15 21:59:59.460189"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 21:59:59.468691"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "02554c45-3130-43a3-b77c-eec61ef98090"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4MzU5OSwianRpIjoiMDI1NTRjNDUtMzEzMC00M2EzLWI3N2MtZWVjNjFlZjk4MDkwIn0.ZKrVLRqBwltMrALs8hzVY-uIQJeVAbixT4N5zSfKHN0"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 21:59:59.468031"], ["revoked", false], ["created_at", "2024-12-15 21:59:59.471545"], ["updated_at", "2024-12-15 21:59:59.471545"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 222ms (Views: 0.2ms | ActiveRecord: 5.1ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 22:00:44 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$q3X79ySr4s.T9QLqNubGt.yuULJ.LM5fGkUt1s3EswvTG90PXQ2pO', '2024-12-15 22:00:50.867118', '2024-12-15 22:00:50.867118')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:00:50 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:00:51.209286"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "85e45221-921e-4ecc-8907-d8b6e7006726"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMTc1MSwianRpIjoiODVlNDUyMjEtOTIxZS00ZWNjLTg5MDctZDhiNmU3MDA2NzI2In0.TpvB7XiZacAWNp0txb5WjtGb40lNFkeohrjZqondeeA"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:15:51.197623"], ["revoked", false], ["created_at", "2024-12-15 22:00:51.217463"], ["updated_at", "2024-12-15 22:00:51.217463"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:00:51.225996"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "40a7dda3-c69d-4c33-a101-2fbafb85b65e"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4MzY1MSwianRpIjoiNDBhN2RkYTMtYzY5ZC00YzMzLWExMDEtMmZiYWZiODViNjVlIn0.C_SogvECuxJXRnabBTPOS66BocwkAw00vjOSkpKk19M"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:00:51.225357"], ["revoked", false], ["created_at", "2024-12-15 22:00:51.228141"], ["updated_at", "2024-12-15 22:00:51.228141"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 221ms (Views: 0.3ms | ActiveRecord: 4.9ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 22:00:51 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$/oRW/hLNUnNex1xy5L1q..jjvpsu6UunBlUA7MKtSdundxxwgHhDa', '2024-12-15 22:01:32.689564', '2024-12-15 22:01:32.689564')[0m
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:01:32 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:01:33.033968"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "21bbbd8a-bcfc-4e4c-9c4f-9165d1540c25"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMTc5MywianRpIjoiMjFiYmJkOGEtYmNmYy00ZTRjLTljNGYtOTE2NWQxNTQwYzI1In0.TyJY3L6vObriXMVtVujxJ-IGijCW4LPrpl80SEMMXrs"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:16:33.021193"], ["revoked", false], ["created_at", "2024-12-15 22:01:33.042345"], ["updated_at", "2024-12-15 22:01:33.042345"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:01:33.050996"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "739a6886-5eff-49d1-a3bc-cb7f1abc4c87"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4MzY5MywianRpIjoiNzM5YTY4ODYtNWVmZi00OWQxLWEzYmMtY2I3ZjFhYmM0Yzg3In0.YFIinVdshbXTZgEMoStF8ii-mnEEDnBYeC-oQC2N1TE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:01:33.050376"], ["revoked", false], ["created_at", "2024-12-15 22:01:33.053681"], ["updated_at", "2024-12-15 22:01:33.053681"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 223ms (Views: 0.2ms | ActiveRecord: 5.4ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 22:01:33 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$zGZ97JVdwBh3AnnB/w6OPOWzbecZO8LTr62gsq2O9rYUzWQ51N2y6', '2024-12-15 22:04:08.574931', '2024-12-15 22:04:08.574931')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:04:08 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:04:08.931936"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "2b7a7145-6355-481d-8f87-703eff49a2b1"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMTk0OCwianRpIjoiMmI3YTcxNDUtNjM1NS00ODFkLThmODctNzAzZWZmNDlhMmIxIn0.p8t8RD9lLPBTCZ3d5awQu5UvlbJqGzMH7KqV-yMN4ag"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:19:08.918371"], ["revoked", false], ["created_at", "2024-12-15 22:04:08.941012"], ["updated_at", "2024-12-15 22:04:08.941012"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:04:08.950779"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.0ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "6494f3cb-02ff-4b88-ba5c-43efcca3ac21"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4Mzg0OCwianRpIjoiNjQ5NGYzY2ItMDJmZi00Yjg4LWJhNWMtNDNlZmNjYTNhYzIxIn0.Y2WnYw95cArhnhEGubRCEjemFg6xpmy4MvGDzeDz0Yo"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:04:08.950052"], ["revoked", false], ["created_at", "2024-12-15 22:04:08.953287"], ["updated_at", "2024-12-15 22:04:08.953287"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 228ms (Views: 0.2ms | ActiveRecord: 5.5ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 22:04:08 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$PKAmzzo.VDlrEebtH2aBvusaKEaJ7GAaaUvF7rHH2Wj9kkyDDnQw2', '2024-12-15 22:05:21.921951', '2024-12-15 22:05:21.921951')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:05:22 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:05:22.264818"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "8848b3e5-d2db-4ab8-a4cd-a623c7f223f7"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjAyMiwianRpIjoiODg0OGIzZTUtZDJkYi00YWI4LWE0Y2QtYTYyM2M3ZjIyM2Y3In0.Mqz3uCe55SbKSOY_vR9FRFwZl7VzH15Rq30S9uPN4Fw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:20:22.252852"], ["revoked", false], ["created_at", "2024-12-15 22:05:22.272989"], ["updated_at", "2024-12-15 22:05:22.272989"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:05:22.282317"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "8e4ef357-2699-40c5-b035-55e094b864f8"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4MzkyMiwianRpIjoiOGU0ZWYzNTctMjY5OS00MGM1LWIwMzUtNTVlMDk0Yjg2NGY4In0.Q1vZuV3oetmsZqtHJOtr4230IE6vJmRgtbqvz7U17hI"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:05:22.281658"], ["revoked", false], ["created_at", "2024-12-15 22:05:22.284449"], ["updated_at", "2024-12-15 22:05:22.284449"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 224ms (Views: 0.3ms | ActiveRecord: 5.1ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 22:07:20 -0300
Processing by UsersController#about_me as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$MaHqxxmi.fCboQKWlPoG9OZ4WFlv0bLDbTufzjmLGW96DuTEc5zpi', '2024-12-15 22:07:29.801447', '2024-12-15 22:07:29.801447')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:07:29 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:07:30.144623"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "8dbc9835-49b7-4853-b031-682a7a9c3f1c"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjE1MCwianRpIjoiOGRiYzk4MzUtNDliNy00ODUzLWIwMzEtNjgyYTdhOWMzZjFjIn0.EFrIH2M7AiGnMU7OfygAJrPDz1M_uno0ksjVZ34Fd2c"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:22:30.132701"], ["revoked", false], ["created_at", "2024-12-15 22:07:30.152772"], ["updated_at", "2024-12-15 22:07:30.152772"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:07:30.161071"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "5904b74d-dda5-43ce-ba96-3381e6349fdf"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDA1MCwianRpIjoiNTkwNGI3NGQtZGRhNS00M2NlLWJhOTYtMzM4MWU2MzQ5ZmRmIn0.60jLph4L3Bc60BL4kd39SGM7g6U7KLV9aQesCiZMcns"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:07:30.160472"], ["revoked", false], ["created_at", "2024-12-15 22:07:30.163119"], ["updated_at", "2024-12-15 22:07:30.163119"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 223ms (Views: 0.2ms | ActiveRecord: 5.1ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-15 22:07:30 -0300
Processing by UsersController#about_me as HTML
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "8dbc9835-49b7-4853-b031-682a7a9c3f1c"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 0.3ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$gwEw/jEEKAnqiOdJlNhZYu01BGqwFEOk6x0d4fttMaR.AxAmsh3Ay', '2024-12-15 22:10:21.938860', '2024-12-15 22:10:21.938860')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:10:22 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:22.283743"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "ef1d102f-2574-4bd3-9ced-68ed1900f56b"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjMyMiwianRpIjoiZWYxZDEwMmYtMjU3NC00YmQzLTljZWQtNjhlZDE5MDBmNTZiIn0.j3E8cXNthum3creNvim0HMNqvpDfxUfB4hdyTXG2rBE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:25:22.271691"], ["revoked", false], ["created_at", "2024-12-15 22:10:22.292303"], ["updated_at", "2024-12-15 22:10:22.292303"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:22.300816"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "1734436e-71dd-44bb-b641-49a212aa57cc"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDIyMiwianRpIjoiMTczNDQzNmUtNzFkZC00NGJiLWI2NDEtNDlhMjEyYWE1N2NjIn0.UavIbPlbvx1VHdBpT7D7AA_njc_CxZrAP4tjiiZg7iA"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:10:22.300180"], ["revoked", false], ["created_at", "2024-12-15 22:10:22.302946"], ["updated_at", "2024-12-15 22:10:22.302946"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 222ms (Views: 0.2ms | ActiveRecord: 5.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$DiWvh8KTKuFwK.kJgCpuCuF59yDprTWgR4qiRq6jqsjmcDAbQ6QBO', '2024-12-15 22:10:36.558478', '2024-12-15 22:10:36.558478')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:10:36 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:36.904030"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "b726328e-8dd1-4d1b-a835-7403c461c029"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjMzNiwianRpIjoiYjcyNjMyOGUtOGRkMS00ZDFiLWE4MzUtNzQwM2M0NjFjMDI5In0.CHulnU4qxzJIvJ5-DhKDYv5aY4zhaZ0HF4fTdWboAQg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:25:36.891751"], ["revoked", false], ["created_at", "2024-12-15 22:10:36.912495"], ["updated_at", "2024-12-15 22:10:36.912495"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:36.921652"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "ae9c8c33-c55e-4a5a-ac5b-cd5f1f9b7f64"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDIzNiwianRpIjoiYWU5YzhjMzMtYzU1ZS00YTVhLWFjNWItY2Q1ZjFmOWI3ZjY0In0.QLSIXonX_oa7FeNsGVmlmp1HBWuvaNdRIi2jlp9uSA0"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:10:36.921024"], ["revoked", false], ["created_at", "2024-12-15 22:10:36.924152"], ["updated_at", "2024-12-15 22:10:36.924152"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 222ms (Views: 0.2ms | ActiveRecord: 5.1ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:10:36 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:37.124924"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "2d42acb7-cb6f-47ab-8c34-618e82a4e56d"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjMzNywianRpIjoiMmQ0MmFjYjctY2I2Zi00N2FiLThjMzQtNjE4ZTgyYTRlNTZkIn0.E6gB1gJhb0JxHuAv3Wau0Ey9oudJMwAsgakOBTobZtc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:25:37.124051"], ["revoked", false], ["created_at", "2024-12-15 22:10:37.129851"], ["updated_at", "2024-12-15 22:10:37.129851"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:37.134352"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "b32b99c7-20bf-4b7d-9d6f-31642dc650ee"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDIzNywianRpIjoiYjMyYjk5YzctMjBiZi00YjdkLTlkNmYtMzE2NDJkYzY1MGVlIn0.HhXuHw6rHWVu5VVaXnBtEJ44aiBgW6O5dSjjZfnLbyI"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:10:37.133599"], ["revoked", false], ["created_at", "2024-12-15 22:10:37.135561"], ["updated_at", "2024-12-15 22:10:37.135561"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 185ms (Views: 0.1ms | ActiveRecord: 1.5ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:10:37 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:37.315316"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "c92c53ea-7ce1-4f3f-963b-093b94c579dd"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjMzNywianRpIjoiYzkyYzUzZWEtN2NlMS00ZjNmLTk2M2ItMDkzYjk0YzU3OWRkIn0.gpnyyLj00Ake8rTCKlk9ZD2vDpdb1g30BD9ILlE_8vg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:25:37.314174"], ["revoked", false], ["created_at", "2024-12-15 22:10:37.317584"], ["updated_at", "2024-12-15 22:10:37.317584"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:37.321717"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "504a878f-1d0a-42bb-8fb4-33e953e0296a"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDIzNywianRpIjoiNTA0YTg3OGYtMWQwYS00MmJiLThmYjQtMzNlOTUzZTAyOTZhIn0.tKedpfzylzpg0QmvsTESrQPcanLRLs7K4xWl3jNi3eI"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:10:37.320382"], ["revoked", false], ["created_at", "2024-12-15 22:10:37.324741"], ["updated_at", "2024-12-15 22:10:37.324741"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 179ms (Views: 0.1ms | ActiveRecord: 1.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
RegistrationsControllerTest - test_should_create_user_with_valid_params: NameError raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:10:37 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:37.503520"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "102bd9d7-40d6-4297-9276-953aa91e3bed"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjMzNywianRpIjoiMTAyYmQ5ZDctNDBkNi00Mjk3LTkyNzYtOTUzYWE5MWUzYmVkIn0.NQs0ZsCOAOFQmZs8kvWbiMQnqv5PxX3C4D9hvfh5USw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:25:37.502098"], ["revoked", false], ["created_at", "2024-12-15 22:10:37.506215"], ["updated_at", "2024-12-15 22:10:37.506215"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:10:37.508880"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "5a5d9766-dd56-4d18-997c-1bef0c7cd88a"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDIzNywianRpIjoiNWE1ZDk3NjYtZGQ1Ni00ZDE4LTk5N2MtMWJlZjBjN2NkODhhIn0.sXtYJhArIv2ISbMU1Rpv3jLd2aFumBje_ZbXaWMmxE8"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:10:37.508150"], ["revoked", false], ["created_at", "2024-12-15 22:10:37.510887"], ["updated_at", "2024-12-15 22:10:37.510887"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 177ms (Views: 0.2ms | ActiveRecord: 1.1ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$tDTVLfzo9gpc5SawfSOES.2RpaTcV2K8GY/KpNRsoUrCckZLTB1qC', '2024-12-15 22:11:29.951667', '2024-12-15 22:11:29.951667')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:11:30 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.296685"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "45e5cac5-d667-4ad9-8deb-08a3a547f546"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjM5MCwianRpIjoiNDVlNWNhYzUtZDY2Ny00YWQ5LThkZWItMDhhM2E1NDdmNTQ2In0.7T8JxaBVhyyB-DC5V1AU0N0Qnt_6HtUaO1aTLIUi67U"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:26:30.284705"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.304864"], ["updated_at", "2024-12-15 22:11:30.304864"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.313991"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "8610ec6c-3541-47af-ab79-45fe2ed94de6"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDI5MCwianRpIjoiODYxMGVjNmMtMzU0MS00N2FmLWFiNzktNDVmZTJlZDk0ZGU2In0.9dFhOVnNP2wwlqMR6zqEJUNXBAwoqiYT-sr98_M_ijg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:11:30.313333"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.316057"], ["updated_at", "2024-12-15 22:11:30.316057"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 224ms (Views: 0.2ms | ActiveRecord: 6.5ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-15 22:11:30 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-15 22:11:30.350904"], ["updated_at", "2024-12-15 22:11:30.350904"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 0.1ms | ActiveRecord: 0.6ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:11:30 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.535783"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "90e50b38-35b6-4076-ac38-285b5dd1d657"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjM5MCwianRpIjoiOTBlNTBiMzgtMzViNi00MDc2LWFjMzgtMjg1YjVkZDFkNjU3In0.CFyCPZsqjzp5ZW78mBbkZlxZW2yRNNnb6hcuEVIN4hM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:26:30.534737"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.539458"], ["updated_at", "2024-12-15 22:11:30.539458"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.544290"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "229bb987-f45c-4d75-b37a-849884a090bf"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDI5MCwianRpIjoiMjI5YmI5ODctZjQ1Yy00ZDc1LWIzN2EtODQ5ODg0YTA5MGJmIn0.KAtHu4RG2lhegS1-a_n5YjyoB1KfIO-7JmdGe3DSaoE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:11:30.543475"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.546348"], ["updated_at", "2024-12-15 22:11:30.546348"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 184ms (Views: 0.1ms | ActiveRecord: 1.5ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:11:30 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.725489"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "6bff3262-0f08-43c2-a4a9-7ba0880ca8d5"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjM5MCwianRpIjoiNmJmZjMyNjItMGYwOC00M2MyLWE0YTktN2JhMDg4MGNhOGQ1In0.qor2c4bw5yKCVm_ztWPfhSXcXHiThfyRT24PKYvVCA4"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:26:30.724576"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.727451"], ["updated_at", "2024-12-15 22:11:30.727451"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.730149"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "a3105403-5ecd-407e-bb68-8c9276c33aeb"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDI5MCwianRpIjoiYTMxMDU0MDMtNWVjZC00MDdlLWJiNjgtOGM5Mjc2YzMzYWViIn0.cV8p3dpLkViguWEFyXiyMTyY83x5bCqYYN70_tFN2pE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:11:30.729880"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.731688"], ["updated_at", "2024-12-15 22:11:30.731688"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 174ms (Views: 0.2ms | ActiveRecord: 1.3ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-15 22:11:30 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 0.1ms | ActiveRecord: 0.4ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:11:30 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.919502"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "660f9024-7c3c-4d23-97c6-9eb52d7c2d36"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjM5MCwianRpIjoiNjYwZjkwMjQtN2MzYy00ZDIzLTk3YzYtOWViNTJkN2MyZDM2In0.gG48VVZtGXWnaqLiBRw_Z5lIGIj7_bXt3Gzq-hjCPdw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:26:30.917711"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.922389"], ["updated_at", "2024-12-15 22:11:30.922389"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:11:30.926062"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d7d42488-0a85-443e-8a4a-c42931bb3933"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDI5MCwianRpIjoiZDdkNDI0ODgtMGE4NS00NDNlLThhNGEtYzQyOTMxYmIzOTMzIn0.yTKakmwh6ySR3AU1rhVa2dHT1dVBTIruzsw7YVG8Ats"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:11:30.924653"], ["revoked", false], ["created_at", "2024-12-15 22:11:30.927980"], ["updated_at", "2024-12-15 22:11:30.927980"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 178ms (Views: 0.3ms | ActiveRecord: 1.2ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$/YqYI6J/P3AWowQ4XTw2L.oQ2lCIQg.Rs2QJQaFTEQK0zrnywP9Ya', '2024-12-15 22:14:25.021390', '2024-12-15 22:14:25.021390')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:14:25 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:14:25.364629"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "fa43cf42-d00d-4f84-9637-a1480f6f15ab"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjU2NSwianRpIjoiZmE0M2NmNDItZDAwZC00Zjg0LTk2MzctYTE0ODBmNmYxNWFiIn0.-Pw5xe78qySne47NByeeIJ1U9TY-IHs8q7hrT9ODDnQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:29:25.352384"], ["revoked", false], ["created_at", "2024-12-15 22:14:25.372942"], ["updated_at", "2024-12-15 22:14:25.372942"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:14:25.381630"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.1ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "8128988c-4a33-4846-bc6e-4a80f26b6d4f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDQ2NSwianRpIjoiODEyODk4OGMtNGEzMy00ODQ2LWJjNmUtNGE4MGYyNmI2ZDRmIn0.fNeLB0oUYG_GNd6ShMnbj8L2Lt0bmyKWicrnqg48yng"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:14:25.381030"], ["revoked", false], ["created_at", "2024-12-15 22:14:25.383661"], ["updated_at", "2024-12-15 22:14:25.383661"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 222ms (Views: 0.3ms | ActiveRecord: 5.6ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-15 22:14:25 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "fa43cf42-d00d-4f84-9637-a1480f6f15ab"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 188ms (Views: 0.1ms | ActiveRecord: 1.7ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$hnhucWODEFNNOPqF3xFcP.5RWQcOqinpLjitrwfGlJKXCucXiczBi', '2024-12-15 22:14:49.353419', '2024-12-15 22:14:49.353419')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-15 22:14:49 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:14:49.699136"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "a008e6e5-4690-4c41-bcbb-52670e13d7b0"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDMxMjU4OSwianRpIjoiYTAwOGU2ZTUtNDY5MC00YzQxLWJjYmItNTI2NzBlMTNkN2IwIn0.06FiiVw4757e1XzcLx7y6qzJaVBOCfw_Zzebz4q6uBE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-15 22:29:49.687270"], ["revoked", false], ["created_at", "2024-12-15 22:14:49.707834"], ["updated_at", "2024-12-15 22:14:49.707834"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-15 22:14:49.716357"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "f73599fe-2fdb-4a34-8333-ccedfdc54666"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDQ4NDQ4OSwianRpIjoiZjczNTk5ZmUtMmZkYi00YTM0LTgzMzMtY2NlZGZkYzU0NjY2In0.TV4bOwQa2SpZrjB4eeaLwsGgNNwvaWkZIL2tWhJK8js"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-17 22:14:49.715720"], ["revoked", false], ["created_at", "2024-12-15 22:14:49.718409"], ["updated_at", "2024-12-15 22:14:49.718409"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 222ms (Views: 0.2ms | ActiveRecord: 5.1ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-15 22:14:49 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "a008e6e5-4690-4c41-bcbb-52670e13d7b0"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 188ms (Views: 0.1ms | ActiveRecord: 1.7ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (2.0ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$EdanSXSzkVxtE3ltpcm3NO.BGs8t9GAYEqXGqJt30maj1iOkbEVy2', '2024-12-16 15:49:06.491693', '2024-12-16 15:49:06.491693')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
UserTest: test_should_not_allow_password_with_spaces
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
UserTest: test_should_not_authenticate_user_with_incorrect_password
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------
UserTest: test_should_authenticate_user_with_correct_password
-------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------
UserTest: test_should_not_allow_password_with_accents_or_special_characters
---------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 15:49:06 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:06.926729"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.0ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "b3867c8f-6780-4d4f-a152-7d8eedd7c381"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NTg0NiwianRpIjoiYjM4NjdjOGYtNjc4MC00ZDRmLWExNTItN2Q4ZWVkZDdjMzgxIn0.HkW4HW7bFg6ddeOB8b1SUQbntyChtiTrlc_ZUT5dlxw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:04:06.915202"], ["revoked", false], ["created_at", "2024-12-16 15:49:06.939098"], ["updated_at", "2024-12-16 15:49:06.939098"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:06.951875"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "102062c8-fcd2-4944-a8db-0b2b907885db"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0Nzc0NiwianRpIjoiMTAyMDYyYzgtZmNkMi00OTQ0LWE4ZGItMGIyYjkwNzg4NWRiIn0.gnSoo7OOgO0dI65s3ko0SemWmphb5ZCvQTVCXeopLkk"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 15:49:06.951124"], ["revoked", false], ["created_at", "2024-12-16 15:49:06.956849"], ["updated_at", "2024-12-16 15:49:06.956849"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 232ms (Views: 0.3ms | ActiveRecord: 4.8ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-16 15:49:06 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "b3867c8f-6780-4d4f-a152-7d8eedd7c381"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 183ms (Views: 0.3ms | ActiveRecord: 2.8ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.328424"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d46f02d3-c550-4e32-807a-bdc618d3ce4f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NTg0NywianRpIjoiZDQ2ZjAyZDMtYzU1MC00ZTMyLTgwN2EtYmRjNjE4ZDNjZTRmIn0.JDR9t_fvYw79yaHChb_74fcINFqUk0rQvhRxc0HumfE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:04:07.327320"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.330521"], ["updated_at", "2024-12-16 15:49:07.330521"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.334151"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "fa2156d9-8249-4d3f-aeef-ab5ced2eeed8"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0Nzc0NywianRpIjoiZmEyMTU2ZDktODI0OS00ZDNmLWFlZWYtYWI1Y2VkMmVlZWQ4In0.kShCupU_201T3ld5Bk2W5V_euDRPpueBM3ubothA1co"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 15:49:07.333833"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.335556"], ["updated_at", "2024-12-16 15:49:07.335556"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 180ms (Views: 0.1ms | ActiveRecord: 1.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "d46f02d3-c550-4e32-807a-bdc618d3ce4f"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 15:49:07.353145"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 1.4ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.539456"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "bc9a7312-9deb-44f6-ae1d-a047cf973604"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NTg0NywianRpIjoiYmM5YTczMTItOWRlYi00NGY2LWFlMWQtYTA0N2NmOTczNjA0In0.iD0HqrZ3DzkCFi84rWKpD1d4ChSWNN9rTMo4GqNXoRU"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:04:07.537027"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.545161"], ["updated_at", "2024-12-16 15:49:07.545161"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.551042"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "e655800e-c5d3-41ee-8dde-c08d60fd1e2f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0Nzc0NywianRpIjoiZTY1NTgwMGUtYzVkMy00MWVlLThkZGUtYzA4ZDYwZmQxZTJmIn0.7ZRk1-gTwt2_PlQxS9YAx_En6ALb47A-6IvueI8WaLQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 15:49:07.549397"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.554142"], ["updated_at", "2024-12-16 15:49:07.554142"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 186ms (Views: 0.1ms | ActiveRecord: 2.3ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "bc9a7312-9deb-44f6-ae1d-a047cf973604"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", ""], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 12ms (Views: 0.3ms | ActiveRecord: 0.7ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.752178"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "e5d4adc5-5d57-4d8b-8aa9-e8ac803021b2"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NTg0NywianRpIjoiZTVkNGFkYzUtNWQ1Ny00ZDhiLThhYTktZThhYzgwMzAyMWIyIn0.inC01u2nL52keR9ci0l8T3g9EovjNtBujcDS6sltizk"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:04:07.750864"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.754462"], ["updated_at", "2024-12-16 15:49:07.754462"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.758374"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "339f2583-a121-467e-b0a1-d514a1727b08"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0Nzc0NywianRpIjoiMzM5ZjI1ODMtYTEyMS00NjdlLWIwYTEtZDUxNGExNzI3YjA4In0.7i5Q8CKec4RSBOCZrErEgHrPgLpokwU4HZfhwHaKm7g"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 15:49:07.756276"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.759175"], ["updated_at", "2024-12-16 15:49:07.759175"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 177ms (Views: 0.2ms | ActiveRecord: 1.2ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-16 15:49:07.774597"], ["updated_at", "2024-12-16 15:49:07.774597"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.1ms | ActiveRecord: 0.7ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.952451"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "269a9acf-be94-4336-a558-ced76648c38d"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NTg0NywianRpIjoiMjY5YTlhY2YtYmU5NC00MzM2LWE1NTgtY2VkNzY2NDhjMzhkIn0.w4xaymAL-KLktm1tKb8a0wsVUaPIyhw2czMJKaL2m-g"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:04:07.951538"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.953598"], ["updated_at", "2024-12-16 15:49:07.953598"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:07.956723"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "ec5c551a-fe21-4f28-bd82-520c05ac2a6e"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0Nzc0NywianRpIjoiZWM1YzU1MWEtZmUyMS00ZjI4LWJkODItNTIwYzA1YWMyYTZlIn0.JS4syVboGVG2Mp5byyO9qB-culpVJsQyuyXJ8R211Nc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 15:49:07.956498"], ["revoked", false], ["created_at", "2024-12-16 15:49:07.958040"], ["updated_at", "2024-12-16 15:49:07.958040"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 175ms (Views: 0.4ms | ActiveRecord: 2.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 11ms (Views: 1.0ms | ActiveRecord: 0.4ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 15:49:07 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:08.163153"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "e9331a09-47f7-4fae-8365-dac50ddd30d0"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NTg0OCwianRpIjoiZTkzMzFhMDktNDdmNy00ZmFlLTgzNjUtZGFjNTBkZGQzMGQwIn0.2uhXUW47xv4RpfloLmG5gDyP68mPxe2yx5aF6Z2hgNE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:04:08.162776"], ["revoked", false], ["created_at", "2024-12-16 15:49:08.164956"], ["updated_at", "2024-12-16 15:49:08.164956"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:08.165864"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "877dcfd5-f870-4e0e-921e-5d6bfea1f8b1"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0Nzc0OCwianRpIjoiODc3ZGNmZDUtZjg3MC00ZTBlLTkyMWUtNWQ2YmZlYTFmOGIxIn0.K0iv_8chS7mZteik86q_ypBBEP5y5CoPRsPzVl9qVfs"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 15:49:08.165778"], ["revoked", false], ["created_at", "2024-12-16 15:49:08.166649"], ["updated_at", "2024-12-16 15:49:08.166649"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 175ms (Views: 0.2ms | ActiveRecord: 1.2ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-16 15:49:08 -0300
Processing by UsersController#about_me as HTML
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "e9331a09-47f7-4fae-8365-dac50ddd30d0"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 0.3ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:08.186245"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:08.192019"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:08.198086"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 15:49:08.230753"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$GbNVZLDodk6HmMRgbU4eVuN6a3KBzfrinpNO2aL3aEwb6HLEBp5jC', '2024-12-16 15:55:15.216090', '2024-12-16 15:55:15.216090')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started GET "/backend/v1/hello" for 127.0.0.1 at 2024-12-16 15:55:15 -0300
Processing by HomeController#hello as HTML
Filter chain halted as :require_authentication rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (3.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.5ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$D80/aK6xLLC8ANAWTJmoue79JmAU/24mKhChjAmjcP1yqljGLzTn.', '2024-12-16 16:04:25.997542', '2024-12-16 16:04:25.997542')[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:04:26 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.7ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:04:26.375788"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.0ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "afb74d99-6c24-4f40-841a-f98e60d3541e"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3Njc2NiwianRpIjoiYWZiNzRkOTktNmMyNC00ZjQwLTg0MWEtZjk4ZTYwZDM1NDFlIn0.TSCCaNnjy9k98uKNFGLrr_mTVT8veF_KWocDQ1GMLg0"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:19:26.362614"], ["revoked", false], ["created_at", "2024-12-16 16:04:26.387766"], ["updated_at", "2024-12-16 16:04:26.387766"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:04:26.397163"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "316a1f68-1532-454b-92fb-c379b88bf4d7"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0ODY2NiwianRpIjoiMzE2YTFmNjgtMTUzMi00NTRiLTkyZmItYzM3OWI4OGJmNGQ3In0.gs805WSya4EL3A4488bwbhtxkCnSEWEG7IMEGMOj1Rk"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:04:26.396242"], ["revoked", false], ["created_at", "2024-12-16 16:04:26.399692"], ["updated_at", "2024-12-16 16:04:26.399692"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 232ms (Views: 0.3ms | ActiveRecord: 7.8ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$YES.At2jaVFEeEiY.PDgau9TWi9FxijkYtPE9wSKYQcNuCvZFWEsS', '2024-12-16 16:04:40.982414', '2024-12-16 16:04:40.982414')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:04:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:04:41.370938"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "2058452f-a946-423f-8615-cb4e5c846daa"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3Njc4MSwianRpIjoiMjA1ODQ1MmYtYTk0Ni00MjNmLTg2MTUtY2I0ZTVjODQ2ZGFhIn0.bUpdQ5QH9hpfwhtTGqxPH2C4xgR99r4qjqPMi_MOPLw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:19:41.356618"], ["revoked", false], ["created_at", "2024-12-16 16:04:41.382682"], ["updated_at", "2024-12-16 16:04:41.382682"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:04:41.393154"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "7f16986a-701b-4795-b034-84411787dc1f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0ODY4MSwianRpIjoiN2YxNjk4NmEtNzAxYi00Nzk1LWIwMzQtODQ0MTE3ODdkYzFmIn0.UHFxcSxHWA5Isg3wCCoT8FY6yafdpaRrZbwZBVaHGNs"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:04:41.392363"], ["revoked", false], ["created_at", "2024-12-16 16:04:41.395768"], ["updated_at", "2024-12-16 16:04:41.395768"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 238ms (Views: 0.4ms | ActiveRecord: 6.8ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/hello" for 127.0.0.1 at 2024-12-16 16:04:41 -0300
Processing by HomeController#hello as HTML
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "2058452f-a946-423f-8615-cb4e5c846daa"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 1.1ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.5ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$oLwghGV7xfk4mDB//Es/a.A9DnZMaEsvyjJ3FT48Ps5Xw4NvqWTvm', '2024-12-16 16:10:21.652212', '2024-12-16 16:10:21.652212')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.4ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:10:21 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:21.997668"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d6886381-3c00-4b13-a9aa-4d047190c76b"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NzEyMSwianRpIjoiZDY4ODYzODEtM2MwMC00YjEzLWE5YWEtNGQwNDcxOTBjNzZiIn0.cxDlNk4XAiYQUKa57XWOA4HVesf6Hkn61zbRB6mHJLg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:25:21.985278"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.006718"], ["updated_at", "2024-12-16 16:10:22.006718"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:22.020047"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d6959b87-1453-4186-838c-a5afecf5424d"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTAyMiwianRpIjoiZDY5NTliODctMTQ1My00MTg2LTgzOGMtYTVhZmVjZjU0MjRkIn0.dmabdi0YloItg23Ln_tyuOhztAo9Q-NWGvi9JmMnRUw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:10:22.019086"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.022584"], ["updated_at", "2024-12-16 16:10:22.022584"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 233ms (Views: 0.3ms | ActiveRecord: 6.6ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/hello" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by HomeController#hello as HTML
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "d6886381-3c00-4b13-a9aa-4d047190c76b"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 0.5ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:22.243010"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "877c39ab-1355-4034-8114-c7c258f4f155"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NzEyMiwianRpIjoiODc3YzM5YWItMTM1NS00MDM0LTgxMTQtYzdjMjU4ZjRmMTU1In0.cZ5CcryA6P1qX8LK1mLzL0ItqO-zZzlyKftgNBsBDvM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:25:22.241316"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.248485"], ["updated_at", "2024-12-16 16:10:22.248485"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:22.252980"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "1d26f31a-fea8-42a5-bafc-3793223b3b70"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTAyMiwianRpIjoiMWQyNmYzMWEtZmVhOC00MmE1LWJhZmMtMzc5MzIyM2IzYjcwIn0.lsxqolz3KfDXu6-NOuP45p0R8a0gV9GtWf8NQVQoiVo"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:10:22.252360"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.254395"], ["updated_at", "2024-12-16 16:10:22.254395"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 187ms (Views: 0.1ms | ActiveRecord: 1.9ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by UsersController#about_me as HTML
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "877c39ab-1355-4034-8114-c7c258f4f155"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 0.2ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:22.449795"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "438c9741-f066-4365-a3c7-cc5572e58bef"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NzEyMiwianRpIjoiNDM4Yzk3NDEtZjA2Ni00MzY1LWEzYzctY2M1NTcyZTU4YmVmIn0.dmMYtOPZ49JhFuI9hUd0cLcHj7n4Nx_WVg_ZHPFOp-w"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:25:22.448798"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.452360"], ["updated_at", "2024-12-16 16:10:22.452360"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:22.458428"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "01f73dd1-7bee-43b7-ba7e-d05161262560"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTAyMiwianRpIjoiMDFmNzNkZDEtN2JlZS00M2I3LWJhN2UtZDA1MTYxMjYyNTYwIn0.nJfNtFFFK2bBKl8KgSYit4sg2P8jdG-P6mkiDcSxCBc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:10:22.456739"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.460091"], ["updated_at", "2024-12-16 16:10:22.460091"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 183ms (Views: 0.1ms | ActiveRecord: 1.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 11ms (Views: 0.6ms | ActiveRecord: 1.1ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:22.658156"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "c05d6b8e-a59b-4dc9-96d4-8a8279b5b689"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NzEyMiwianRpIjoiYzA1ZDZiOGUtYTU5Yi00ZGM5LTk2ZDQtOGE4Mjc5YjViNjg5In0.4FHazpELWf2Tx8ef5KoqyXJZc_ZinGo0F6iGKlXkBoM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:25:22.656992"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.660583"], ["updated_at", "2024-12-16 16:10:22.660583"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:22.663684"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d26141f2-f8c1-42d0-aaee-803f70685b18"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTAyMiwianRpIjoiZDI2MTQxZjItZjhjMS00MmQwLWFhZWUtODAzZjcwNjg1YjE4In0.qgcytjfM1ZLirXN27-x_K0u50cnt7rmTUuJFiGqZHhY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:10:22.662167"], ["revoked", false], ["created_at", "2024-12-16 16:10:22.665472"], ["updated_at", "2024-12-16 16:10:22.665472"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 179ms (Views: 0.1ms | ActiveRecord: 1.3ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "c05d6b8e-a59b-4dc9-96d4-8a8279b5b689"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 179ms (Views: 0.3ms | ActiveRecord: 2.7ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:10:22 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.033952"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "b2cefa03-9655-44f2-9cca-610dfe9f4838"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NzEyMywianRpIjoiYjJjZWZhMDMtOTY1NS00NGYyLTljY2EtNjEwZGZlOWY0ODM4In0.y6_wbY5xSgi7W1SKC1xHk5PRxV-W2N2QdK4n6veqWlQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:25:23.030459"], ["revoked", false], ["created_at", "2024-12-16 16:10:23.037272"], ["updated_at", "2024-12-16 16:10:23.037272"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.040903"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "64d8b8aa-34e5-46f3-9c2e-a74059af4347"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTAyMywianRpIjoiNjRkOGI4YWEtMzRlNS00NmYzLTljMmUtYTc0MDU5YWY0MzQ3In0.mEAkF7aGzPrMr5f5hYYaYO1L6Veol4llmWmAwc4oank"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:10:23.040080"], ["revoked", false], ["created_at", "2024-12-16 16:10:23.045633"], ["updated_at", "2024-12-16 16:10:23.045633"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 189ms (Views: 0.3ms | ActiveRecord: 2.2ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:10:23 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "b2cefa03-9655-44f2-9cca-610dfe9f4838"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", ""], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 17ms (Views: 0.8ms | ActiveRecord: 1.6ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:10:23 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.254321"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "f3c5afc2-73c0-48ed-8c68-598f20cb292f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NzEyMywianRpIjoiZjNjNWFmYzItNzNjMC00OGVkLThjNjgtNTk4ZjIwY2IyOTJmIn0.-UjGQAzkfead1DF-0yr9_ydkAHP9uzA-6HXIKdWM7iU"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:25:23.253066"], ["revoked", false], ["created_at", "2024-12-16 16:10:23.257828"], ["updated_at", "2024-12-16 16:10:23.257828"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.259462"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "fef90a65-b82d-405b-8aeb-c48317040ac4"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTAyMywianRpIjoiZmVmOTBhNjUtYjgyZC00MDViLThhZWItYzQ4MzE3MDQwYWM0In0.40wyHpnj-ea-bRipMbKAHyfbUnAEioQZG_d1aHm-jvM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:10:23.259284"], ["revoked", false], ["created_at", "2024-12-16 16:10:23.262188"], ["updated_at", "2024-12-16 16:10:23.262188"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 179ms (Views: 0.3ms | ActiveRecord: 1.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:10:23 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-16 16:10:23.277619"], ["updated_at", "2024-12-16 16:10:23.277619"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 15ms (Views: 0.2ms | ActiveRecord: 1.2ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:10:23 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.458027"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "1f86cd6f-4942-4133-b174-3713922881e2"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3NzEyMywianRpIjoiMWY4NmNkNmYtNDk0Mi00MTMzLWIxNzQtMzcxMzkyMjg4MWUyIn0.OxMjEMXpbTOOQspDlTGJ89AMFwDip68keG-xPYduEWQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:25:23.457392"], ["revoked", false], ["created_at", "2024-12-16 16:10:23.460631"], ["updated_at", "2024-12-16 16:10:23.460631"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.463163"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "03609733-5a29-4d61-8c57-c19d83cd3fee"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTAyMywianRpIjoiMDM2MDk3MzMtNWEyOS00ZDYxLThjNTctYzE5ZDgzY2QzZmVlIn0.wB_U2jYjGTha3xo-jWRIC9Xa1rFFKWmhb0FyMnCwzMY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:10:23.463073"], ["revoked", false], ["created_at", "2024-12-16 16:10:23.464310"], ["updated_at", "2024-12-16 16:10:23.464310"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 177ms (Views: 0.1ms | ActiveRecord: 1.1ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:10:23 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "1f86cd6f-4942-4133-b174-3713922881e2"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:10:23.471350"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 0.9ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.484455"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.492540"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.495644"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:10:23.503616"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------
UserTest: test_should_not_allow_password_with_accents_or_special_characters
---------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
UserTest: test_should_not_allow_password_with_spaces
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------
UserTest: test_should_authenticate_user_with_correct_password
-------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
UserTest: test_should_not_authenticate_user_with_incorrect_password
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$1/H20.V7tsVf6vbQbjKE2OT0FMSBWm0OQWOy5HGK6C/JtnjqB.vD6', '2024-12-16 16:24:34.670337', '2024-12-16 16:24:34.670337')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.9ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:24:34 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:24:35.053314"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.1ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "b350c888-6027-4703-b7c2-57276c0f232c"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3Nzk3NSwianRpIjoiYjM1MGM4ODgtNjAyNy00NzAzLWI3YzItNTcyNzZjMGYyMzJjIn0.FFZ8MesHMM8RsFjt3RVBOmR_XSu9V3itwn0JakEO66c"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:39:35.036401"], ["revoked", false], ["created_at", "2024-12-16 16:24:35.064319"], ["updated_at", "2024-12-16 16:24:35.064319"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:24:35.076389"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.1ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "4e9d80c8-94f7-4b0a-bece-086c5a09948c"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTg3NSwianRpIjoiNGU5ZDgwYzgtOTRmNy00YjBhLWJlY2UtMDg2YzVhMDk5NDhjIn0.-e4KMw7PAzdnbKAicmZ-rVn44wlA7S3gOrUa4DOoY8Y"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:24:35.075333"], ["revoked", false], ["created_at", "2024-12-16 16:24:35.079027"], ["updated_at", "2024-12-16 16:24:35.079027"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 235ms (Views: 0.3ms | ActiveRecord: 7.2ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:24:35 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 16ms (Views: 0.2ms | ActiveRecord: 0.7ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (3.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$Xs9h7yw2TX5LFDy.Ty5EHOLUfnzt3sbud8yyFDM21LK54JhkxUjMi', '2024-12-16 16:25:17.038831', '2024-12-16 16:25:17.038831')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:25:17 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:25:17.421503"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.1ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "c5a9cc22-8c50-434f-9616-fc5b7ed62d89"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3ODAxNywianRpIjoiYzVhOWNjMjItOGM1MC00MzRmLTk2MTYtZmM1YjdlZDYyZDg5In0.gMjpWoeQvcfpkj6NBrB6QSh1mn4YuupUZ_9QI7HiNTI"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:40:17.403683"], ["revoked", false], ["created_at", "2024-12-16 16:25:17.430655"], ["updated_at", "2024-12-16 16:25:17.430655"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:25:17.440645"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d6d223b8-97e5-406c-a627-87f5819c30a6"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTkxNywianRpIjoiZDZkMjIzYjgtOTdlNS00MDZjLWE2MjctODdmNTgxOWMzMGE2In0.T6IBP5qSeRKcSYqVBULxiFnmQkYfoM9wlmloi-hw42M"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:25:17.439758"], ["revoked", false], ["created_at", "2024-12-16 16:25:17.443926"], ["updated_at", "2024-12-16 16:25:17.443926"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 236ms (Views: 0.3ms | ActiveRecord: 7.5ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:25:17 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 17ms (Views: 0.2ms | ActiveRecord: 0.8ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$0hj12u6.VPGZ7p43X6fS5e32WyaAasCgEemngU3sKT.o5rtEHRn9K', '2024-12-16 16:25:34.917821', '2024-12-16 16:25:34.917821')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.7ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:25:35 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:25:35.301270"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "7e5ff6a5-7edc-40d7-889f-e939023a4d4f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3ODAzNSwianRpIjoiN2U1ZmY2YTUtN2VkYy00MGQ3LTg4OWYtZTkzOTAyM2E0ZDRmIn0.lE_XYg3Q2SmbgP-ccVkTQRopRNQ_gBl6a4tNdNXruRc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 16:40:35.288828"], ["revoked", false], ["created_at", "2024-12-16 16:25:35.313550"], ["updated_at", "2024-12-16 16:25:35.313550"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:25:35.324006"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d125aa69-9a8e-4bb3-a988-f84484da5a27"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU0OTkzNSwianRpIjoiZDEyNWFhNjktOWE4ZS00YmIzLWE5ODgtZjg0NDg0ZGE1YTI3In0.X79MHFidIczhyUjlIS5znDTWOtO2zXIfjD_zQjF57-c"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:25:35.323270"], ["revoked", false], ["created_at", "2024-12-16 16:25:35.326733"], ["updated_at", "2024-12-16 16:25:35.326733"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 237ms (Views: 0.6ms | ActiveRecord: 5.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:25:35 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "7e5ff6a5-7edc-40d7-889f-e939023a4d4f"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:25:35.380403"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 1.6ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$DD0Dy43NfxY47qwXkESp7enHJeCowOOKTeGcJWWzyERPHpH8TC272', '2024-12-16 16:45:24.749920', '2024-12-16 16:45:24.749920')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.4ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:45:24 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:45:25.143457"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.8ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "dc3dcdbe-77c6-4413-8209-a65106015de0"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTIyNSwianRpIjoiZGMzZGNkYmUtNzdjNi00NDEzLTgyMDktYTY1MTA2MDE1ZGUwIn0.7Hb7GcDCYdUOYYuLMPtrCMcHmkzKArJD_PTOGo3oDhA"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:00:25.129988"], ["revoked", false], ["created_at", "2024-12-16 16:45:25.154265"], ["updated_at", "2024-12-16 16:45:25.154265"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:45:25.163404"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (2.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "7f461d22-2c90-46ba-a272-e5241348979a"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTEyNSwianRpIjoiN2Y0NjFkMjItMmM5MC00NmJhLWEyNzItZTUyNDEzNDg5NzlhIn0.LYW0Hr4NiUL4gOCCdbtIxmd-EkibPKXfCemrJXG07LQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:45:25.162710"], ["revoked", false], ["created_at", "2024-12-16 16:45:25.165590"], ["updated_at", "2024-12-16 16:45:25.165590"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 230ms (Views: 0.5ms | ActiveRecord: 7.9ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:45:25 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "dc3dcdbe-77c6-4413-8209-a65106015de0"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:45:25.217434"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 1.6ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (3.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$8nkUlPEYgLaCoKSIlv5y9.l3gSe3qeHNqu9CWSU31jHrf21A1Kv6.', '2024-12-16 16:46:26.912471', '2024-12-16 16:46:26.912471')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:46:27 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:27.290843"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "68f92835-c868-4f6b-b811-152f607cb644"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTI4NywianRpIjoiNjhmOTI4MzUtYzg2OC00ZjZiLWI4MTEtMTUyZjYwN2NiNjQ0In0.AAZBgJ50W-ksDfByTmS-r8jA066Cfwmy0e8-n6lXhJI"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:01:27.277255"], ["revoked", false], ["created_at", "2024-12-16 16:46:27.299989"], ["updated_at", "2024-12-16 16:46:27.299989"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:27.310456"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "7eb9267f-1f4a-4795-b215-386722074f6a"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTE4NywianRpIjoiN2ViOTI2N2YtMWY0YS00Nzk1LWIyMTUtMzg2NzIyMDc0ZjZhIn0.MoBZVPeZ50fB9j6t71ST4N3yv8SHfoPELOsReqtr3XQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:46:27.309695"], ["revoked", false], ["created_at", "2024-12-16 16:46:27.313052"], ["updated_at", "2024-12-16 16:46:27.313052"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 234ms (Views: 0.3ms | ActiveRecord: 7.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-16 16:46:27 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "68f92835-c868-4f6b-b811-152f607cb644"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 189ms (Views: 0.1ms | ActiveRecord: 1.9ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:46:27 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:27.714588"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "3c8286e8-eb9f-4fe0-a019-5b7b3848fa91"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTI4NywianRpIjoiM2M4Mjg2ZTgtZWI5Zi00ZmUwLWEwMTktNWI3YjM4NDhmYTkxIn0.lWN54p54MJ5yP17beri9C-XJ6QUacne8cOsiSaaOcV0"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:01:27.713024"], ["revoked", false], ["created_at", "2024-12-16 16:46:27.719380"], ["updated_at", "2024-12-16 16:46:27.719380"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:27.724403"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "aaadd02e-bb8b-4a6f-b659-221b7d5e6d70"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTE4NywianRpIjoiYWFhZGQwMmUtYmI4Yi00YTZmLWI2NTktMjIxYjdkNWU2ZDcwIn0.4EppCICN0ISODyvDCBqtD3IPRH1JyEpqIpMjYir2gXc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:46:27.723899"], ["revoked", false], ["created_at", "2024-12-16 16:46:27.727135"], ["updated_at", "2024-12-16 16:46:27.727135"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 189ms (Views: 0.1ms | ActiveRecord: 1.9ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:46:27 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "3c8286e8-eb9f-4fe0-a019-5b7b3848fa91"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", ""], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 13ms (Views: 0.2ms | ActiveRecord: 1.1ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:46:27 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:27.924206"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "7a74518e-e107-457e-8530-df7f1217de50"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTI4NywianRpIjoiN2E3NDUxOGUtZTEwNy00NTdlLTg1MzAtZGY3ZjEyMTdkZTUwIn0.NsQVtAkug5IoRmDcFXThjyZY-6PGDj7dBNoVjerkRKc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:01:27.922826"], ["revoked", false], ["created_at", "2024-12-16 16:46:27.926276"], ["updated_at", "2024-12-16 16:46:27.926276"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:27.930205"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "a1289ed7-6492-406e-98f1-4e1d72a1506f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTE4NywianRpIjoiYTEyODllZDctNjQ5Mi00MDZlLTk4ZjEtNGUxZDcyYTE1MDZmIn0.twElhMdJd7aLdgFszDRuvWpdGekKVaLb3g042C4MBIQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:46:27.929103"], ["revoked", false], ["created_at", "2024-12-16 16:46:27.932101"], ["updated_at", "2024-12-16 16:46:27.932101"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 178ms (Views: 0.1ms | ActiveRecord: 1.6ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:46:27 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-16 16:46:27.948147"], ["updated_at", "2024-12-16 16:46:27.948147"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 14ms (Views: 0.4ms | ActiveRecord: 1.2ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:46:27 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:28.130256"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "55d3ea00-052c-4f45-b060-3a58baef01d8"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTI4OCwianRpIjoiNTVkM2VhMDAtMDUyYy00ZjQ1LWIwNjAtM2E1OGJhZWYwMWQ4In0.hvP4StkWDn_f99O-0pu7hMMLBvtePakkgXRqrorpqrk"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:01:28.127397"], ["revoked", false], ["created_at", "2024-12-16 16:46:28.132846"], ["updated_at", "2024-12-16 16:46:28.132846"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:28.138106"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "7ab6edd5-6430-4365-a767-25c971992845"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTE4OCwianRpIjoiN2FiNmVkZDUtNjQzMC00MzY1LWE3NjctMjVjOTcxOTkyODQ1In0.Lz96HOCmlqxqtRKEfuoygCZqa5jNoIIHeE48UiY0VcQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:46:28.135387"], ["revoked", false], ["created_at", "2024-12-16 16:46:28.140174"], ["updated_at", "2024-12-16 16:46:28.140174"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 182ms (Views: 0.2ms | ActiveRecord: 1.5ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:46:28 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 14ms (Views: 0.1ms | ActiveRecord: 0.5ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:46:28 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:28.339749"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d495f975-449b-497b-86b4-58cfdccbbb6f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTI4OCwianRpIjoiZDQ5NWY5NzUtNDQ5Yi00OTdiLTg2YjQtNThjZmRjY2JiYjZmIn0.5B5-dSexsJx3poIKDu6AuGGZDGvCq2bUQgxdWPXn_OE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:01:28.338491"], ["revoked", false], ["created_at", "2024-12-16 16:46:28.345455"], ["updated_at", "2024-12-16 16:46:28.345455"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:46:28.347965"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "05541c5f-509a-40d0-976b-9db423f10650"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTE4OCwianRpIjoiMDU1NDFjNWYtNTA5YS00MGQwLTk3NmItOWRiNDIzZjEwNjUwIn0.ZQQ2n0J-hU8oxG5034CTBak6WfbvlvEIa6W5WdRSvHE"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:46:28.347846"], ["revoked", false], ["created_at", "2024-12-16 16:46:28.350194"], ["updated_at", "2024-12-16 16:46:28.350194"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 183ms (Views: 0.4ms | ActiveRecord: 2.3ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:46:28 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "d495f975-449b-497b-86b4-58cfdccbbb6f"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:46:28.364969"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 0.8ms | ActiveRecord: 1.0ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.5ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$C4BkrLYYFkWmHv2M8SNGkuxDogQkT4LUecp2ijEWx8GDEYe2Qbizu', '2024-12-16 16:47:46.596173', '2024-12-16 16:47:46.596173')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:47:46 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:46.976090"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.8ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "fad5696f-447b-4463-b886-de1a29e2224d"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM2NiwianRpIjoiZmFkNTY5NmYtNDQ3Yi00NDYzLWI4ODYtZGUxYTI5ZTIyMjRkIn0.Yt4Bn09oKS4KQm6eSl0ms4yhj73Lf3ILBr9289ftfgk"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:02:46.962110"], ["revoked", false], ["created_at", "2024-12-16 16:47:46.985231"], ["updated_at", "2024-12-16 16:47:46.985231"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:46.994005"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "9c3eb33a-2707-4cbd-9f9a-fac7527582da"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI2NiwianRpIjoiOWMzZWIzM2EtMjcwNy00Y2JkLTlmOWEtZmFjNzUyNzU4MmRhIn0.c2DptVaTMPIkpM1RNKYdiWTdubxSd5n79Lr-J7k2zhI"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:47:46.993337"], ["revoked", false], ["created_at", "2024-12-16 16:47:46.996261"], ["updated_at", "2024-12-16 16:47:46.996261"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 230ms (Views: 0.3ms | ActiveRecord: 7.3ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 15ms (Views: 0.3ms | ActiveRecord: 0.6ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:47.222741"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "184b1cd1-1f5c-4fc7-9046-5218494b6573"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM2NywianRpIjoiMTg0YjFjZDEtMWY1Yy00ZmM3LTkwNDYtNTIxODQ5NGI2NTczIn0.BqXsxvxnypPZAbRK23GHz2snEhoJOkpdRBmu_B_LxDY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:02:47.221748"], ["revoked", false], ["created_at", "2024-12-16 16:47:47.226131"], ["updated_at", "2024-12-16 16:47:47.226131"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:47.230354"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "277bb953-4673-4c4a-a6b3-5a5c6a3dad76"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI2NywianRpIjoiMjc3YmI5NTMtNDY3My00YzRhLWE2YjMtNWE1YzZhM2RhZDc2In0.75s3Wqvvwkuhi8Sn8gwJdttGv1KpWer_LBN-dnx8Zgs"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:47:47.229409"], ["revoked", false], ["created_at", "2024-12-16 16:47:47.232808"], ["updated_at", "2024-12-16 16:47:47.232808"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 186ms (Views: 0.2ms | ActiveRecord: 1.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "184b1cd1-1f5c-4fc7-9046-5218494b6573"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 183ms (Views: 0.2ms | ActiveRecord: 2.0ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.7ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:47.606258"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "e46b9a17-7fff-49a5-af13-16c77420b886"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM2NywianRpIjoiZTQ2YjlhMTctN2ZmZi00OWE1LWFmMTMtMTZjNzc0MjBiODg2In0.A8mOuAPkF2AK99MdzVIEhxaYgW1m-RPyuj_OUzWRu1g"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:02:47.603962"], ["revoked", false], ["created_at", "2024-12-16 16:47:47.610239"], ["updated_at", "2024-12-16 16:47:47.610239"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:47.614643"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "ab7acc68-0848-442b-9c5e-9986c5a2c20f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI2NywianRpIjoiYWI3YWNjNjgtMDg0OC00NDJiLTljNWUtOTk4NmM1YTJjMjBmIn0.FePnUlH0Yk3gGkqZeqX4dgqOdWw7J4AGP4F7XWp3nkM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:47:47.613468"], ["revoked", false], ["created_at", "2024-12-16 16:47:47.616127"], ["updated_at", "2024-12-16 16:47:47.616127"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 183ms (Views: 0.1ms | ActiveRecord: 1.9ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "e46b9a17-7fff-49a5-af13-16c77420b886"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:47:47.628914"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 17ms (Views: 0.4ms | ActiveRecord: 1.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:47.819768"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "2dfdff57-e2f5-496a-ac7a-f76d4771eeb9"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM2NywianRpIjoiMmRmZGZmNTctZTJmNS00OTZhLWFjN2EtZjc2ZDQ3NzFlZWI5In0.HZrKsC_lEjcmR7Q4ed8vTq-3WL5mOJ7-xb7UW8ST27M"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:02:47.816440"], ["revoked", false], ["created_at", "2024-12-16 16:47:47.822432"], ["updated_at", "2024-12-16 16:47:47.822432"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:47.827660"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "c97bc921-f5de-4e6b-85c6-2811100b7ad8"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI2NywianRpIjoiYzk3YmM5MjEtZjVkZS00ZTZiLTg1YzYtMjgxMTEwMGI3YWQ4In0.YeUI9MrzYrrhA4E05pf3nKQVZ3Rdqa1gxJZxPCc9iYM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:47:47.824665"], ["revoked", false], ["created_at", "2024-12-16 16:47:47.830223"], ["updated_at", "2024-12-16 16:47:47.830223"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 185ms (Views: 0.2ms | ActiveRecord: 1.2ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "2dfdff57-e2f5-496a-ac7a-f76d4771eeb9"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", ""], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 17ms (Views: 0.1ms | ActiveRecord: 1.4ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:47:47 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:48.030014"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "87a1cef5-b206-4272-ab6a-25f99d471beb"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM2OCwianRpIjoiODdhMWNlZjUtYjIwNi00MjcyLWFiNmEtMjVmOTlkNDcxYmViIn0.FZUBsT7rSUswFERsEyVie4BOxG8VudyokHNZxjfmtD4"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:02:48.028581"], ["revoked", false], ["created_at", "2024-12-16 16:47:48.033698"], ["updated_at", "2024-12-16 16:47:48.033698"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:47:48.037809"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.0ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "9be421ff-1e1e-4cba-8d1e-ad757709ad09"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI2OCwianRpIjoiOWJlNDIxZmYtMWUxZS00Y2JhLThkMWUtYWQ3NTc3MDlhZDA5In0.oasyPgcvQg5iNnVH60-EGQ7QkPuIjc69_PYPbepac0Y"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:47:48.037638"], ["revoked", false], ["created_at", "2024-12-16 16:47:48.039673"], ["updated_at", "2024-12-16 16:47:48.039673"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 182ms (Views: 0.5ms | ActiveRecord: 3.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:47:48 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-16 16:47:48.059412"], ["updated_at", "2024-12-16 16:47:48.059412"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 1.0ms | ActiveRecord: 0.7ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$/.U7e5IGtmm2Up1j485lfOhbYlWMPUyaZd7hGxvZQUYt5nXkPWQzm', '2024-12-16 16:47:59.909929', '2024-12-16 16:47:59.909929')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (1.0ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.072143"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.084897"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.095081"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.101632"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:48:00 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.342767"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "599798e3-5733-4a27-b575-0cf7f775715a"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM4MCwianRpIjoiNTk5Nzk4ZTMtNTczMy00YTI3LWI1NzUtMGNmN2Y3NzU3MTVhIn0._WaziOJukQwBIxfos5C4qLo4Qm0H8UygL89Y_4LFVUU"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:03:00.340975"], ["revoked", false], ["created_at", "2024-12-16 16:48:00.358181"], ["updated_at", "2024-12-16 16:48:00.358181"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.370484"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "7e788156-76de-4b1e-a2fb-09705400c96e"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI4MCwianRpIjoiN2U3ODgxNTYtNzZkZS00YjFlLWEyZmItMDk3MDU0MDBjOTZlIn0.2A_RONf5OOVjva38LuLqhQs57Gbkd4clFO1O9aPInZQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:48:00.369650"], ["revoked", false], ["created_at", "2024-12-16 16:48:00.373488"], ["updated_at", "2024-12-16 16:48:00.373488"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 217ms (Views: 0.4ms | ActiveRecord: 3.6ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/hello" for 127.0.0.1 at 2024-12-16 16:48:00 -0300
Processing by HomeController#hello as HTML
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "599798e3-5733-4a27-b575-0cf7f775715a"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.4ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:48:00 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.575763"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "94bfa513-cfb6-4bf0-9ffb-b0eb085d990a"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM4MCwianRpIjoiOTRiZmE1MTMtY2ZiNi00YmYwLTlmZmItYjBlYjA4NWQ5OTBhIn0.3IhPJ1BiPXrtuL4g-Ixt8y54lQEC4JDJ3umvSqnh8qo"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:03:00.571262"], ["revoked", false], ["created_at", "2024-12-16 16:48:00.578390"], ["updated_at", "2024-12-16 16:48:00.578390"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.584715"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "285a81eb-39bb-41d7-8e70-88202675da65"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI4MCwianRpIjoiMjg1YTgxZWItMzliYi00MWQ3LThlNzAtODgyMDI2NzVkYTY1In0.hPP2_oNrF8dLEea7MPfl3m8-OUgc5KdMxgZqKWC7cTM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:48:00.582197"], ["revoked", false], ["created_at", "2024-12-16 16:48:00.586615"], ["updated_at", "2024-12-16 16:48:00.586615"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 188ms (Views: 0.1ms | ActiveRecord: 1.4ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:48:00 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "94bfa513-cfb6-4bf0-9ffb-b0eb085d990a"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", ""], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 19ms (Views: 0.2ms | ActiveRecord: 1.7ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:48:00 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.793586"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "1a760dfa-f5e8-433f-a1cd-fae70580940e"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM4MCwianRpIjoiMWE3NjBkZmEtZjVlOC00MzNmLWExY2QtZmFlNzA1ODA5NDBlIn0.XEj3Zfrk9sRi7N1Dz-DHWaT1oN15DkVP_twMBzOh7n0"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:03:00.792501"], ["revoked", false], ["created_at", "2024-12-16 16:48:00.797679"], ["updated_at", "2024-12-16 16:48:00.797679"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:00.806911"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d01a6c21-4951-4cd9-9cf0-d9730e91268d"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI4MCwianRpIjoiZDAxYTZjMjEtNDk1MS00Y2Q5LTljZjAtZDk3MzBlOTEyNjhkIn0.BxjZXpWIMMoa5WTCl9lCebFH7Mu-n1OQafue-a-9lFU"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:48:00.805010"], ["revoked", false], ["created_at", "2024-12-16 16:48:00.810181"], ["updated_at", "2024-12-16 16:48:00.810181"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 190ms (Views: 0.2ms | ActiveRecord: 4.0ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-16 16:48:00 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "1a760dfa-f5e8-433f-a1cd-fae70580940e"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 175ms (Views: 0.4ms | ActiveRecord: 2.1ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:48:00 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.166073"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "b95355b3-acbf-444c-9470-b62d56e2b479"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM4MSwianRpIjoiYjk1MzU1YjMtYWNiZi00NDRjLTk0NzAtYjYyZDU2ZTJiNDc5In0.958tPhGwczgQKmowVleihrILJT39QnYglQseBUMLqkU"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:03:01.165616"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.168046"], ["updated_at", "2024-12-16 16:48:01.168046"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.169417"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "98fcc34b-edec-4cfb-ba16-db0819a5eff0"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI4MSwianRpIjoiOThmY2MzNGItZWRlYy00Y2ZiLWJhMTYtZGIwODE5YTVlZmYwIn0.gWXuFj9TV5TD_H-L2qMJFJZrVaN-HKmMIq8NYFcrvew"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:48:01.169168"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.173540"], ["updated_at", "2024-12-16 16:48:01.173540"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 180ms (Views: 0.1ms | ActiveRecord: 1.6ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:48:01 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 12ms (Views: 0.1ms | ActiveRecord: 0.5ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:48:01 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.372956"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "acf7f839-1fc1-4611-a443-3eae4b2aec51"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM4MSwianRpIjoiYWNmN2Y4MzktMWZjMS00NjExLWE0NDMtM2VhZTRiMmFlYzUxIn0.Ow93usktzugH0tagzCIquAdTvDkEok2aTqsZfQqrhos"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:03:01.372428"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.375811"], ["updated_at", "2024-12-16 16:48:01.375811"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.378541"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.1ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "639d1e13-25ca-4346-a8d2-c82aa14ed8de"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI4MSwianRpIjoiNjM5ZDFlMTMtMjVjYS00MzQ2LWE4ZDItYzgyYWExNGVkOGRlIn0.mRES777EkokqFnS6Yno7g91oPDkRl-FRQ-U8HRXgvjA"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:48:01.378043"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.379931"], ["updated_at", "2024-12-16 16:48:01.379931"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 180ms (Views: 0.1ms | ActiveRecord: 2.2ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:48:01 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-16 16:48:01.395687"], ["updated_at", "2024-12-16 16:48:01.395687"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.7ms | ActiveRecord: 0.6ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:48:01 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.582762"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "17c16277-d0d2-4aac-8806-ba605e8a4dad"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM4MSwianRpIjoiMTdjMTYyNzctZDBkMi00YWFjLTg4MDYtYmE2MDVlOGE0ZGFkIn0.rqOqppwFfA8xQummbHpVNm-UEMOtHsVKf21u9ARiGpc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:03:01.578366"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.585685"], ["updated_at", "2024-12-16 16:48:01.585685"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.587792"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d44a7ccd-8fb3-4d5d-9e4e-c365aeffaacd"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI4MSwianRpIjoiZDQ0YTdjY2QtOGZiMy00ZDVkLTllNGUtYzM2NWFlZmZhYWNkIn0.HJDHVKPYHmENaH5ZuhhjtjbXs3QQclenHOHbL2z0e6M"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:48:01.587372"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.590449"], ["updated_at", "2024-12-16 16:48:01.590449"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 182ms (Views: 0.3ms | ActiveRecord: 1.6ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:48:01 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "17c16277-d0d2-4aac-8806-ba605e8a4dad"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:48:01.600667"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 1.1ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:48:01 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.790612"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "9953fd23-73f7-4135-b342-c3a9964e7404"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTM4MSwianRpIjoiOTk1M2ZkMjMtNzNmNy00MTM1LWIzNDItYzNhOTk2NGU3NDA0In0.6H2iuClGs-2c1twWcAd1aV6xVGGeOc2tHScO5j-7WEY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:03:01.790183"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.792098"], ["updated_at", "2024-12-16 16:48:01.792098"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:48:01.793462"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "94c3c796-b1b4-4b7d-b33f-91e1197e27cf"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTI4MSwianRpIjoiOTRjM2M3OTYtYjFiNC00YjdkLWIzM2YtOTFlMTE5N2UyN2NmIn0.iLB1Krtx0N4Y7rJQdCbHTwskJCIF6xaRfmeremnAJP8"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:48:01.793340"], ["revoked", false], ["created_at", "2024-12-16 16:48:01.794636"], ["updated_at", "2024-12-16 16:48:01.794636"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 171ms (Views: 0.1ms | ActiveRecord: 1.3ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-16 16:48:01 -0300
Processing by UsersController#about_me as HTML
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "9953fd23-73f7-4135-b342-c3a9964e7404"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.2ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$MyjNirE87NuNYrYgF43skObElpAUarDyzu5SRrCbd4OO1hPfFVZDu', '2024-12-16 16:54:23.659209', '2024-12-16 16:54:23.659209')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:23 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.042885"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.0ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "a190c8cf-4c26-4dcb-a236-10d2215b4bf4"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc2NCwianRpIjoiYTE5MGM4Y2YtNGMyNi00ZGNiLWEyMzYtMTBkMjIxNWI0YmY0In0.vtK7lkpzTsnbpUlXaN8Ro-fxz91_BiKbGgMUGJekkpk"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:24.029006"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.053936"], ["updated_at", "2024-12-16 16:54:24.053936"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.063577"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "0b39211d-4247-4433-99b0-2521c0df4b14"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY2NCwianRpIjoiMGIzOTIxMWQtNDI0Ny00NDMzLTk5YjAtMjUyMWMwZGY0YjE0In0.-DGsKl6kFdZT3zyXC29klVKSYDPpoPOUqvkkifDjG54"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:24.062859"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.066487"], ["updated_at", "2024-12-16 16:54:24.066487"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 234ms (Views: 0.4ms | ActiveRecord: 7.3ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "a190c8cf-4c26-4dcb-a236-10d2215b4bf4"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", ""], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 29ms (Views: 0.1ms | ActiveRecord: 1.4ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.303575"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d54e2d65-7269-4848-af47-9b7f6761dca4"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc2NCwianRpIjoiZDU0ZTJkNjUtNzI2OS00ODQ4LWFmNDctOWI3ZjY3NjFkY2E0In0.sHgSLJpMIrib_1tZwZ3xMfO6TngBNKhOTTCY9V_squM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:24.301841"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.309917"], ["updated_at", "2024-12-16 16:54:24.309917"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.314326"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "0873b1f8-a12d-4fb1-82a3-b0a1f0897eec"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY2NCwianRpIjoiMDg3M2IxZjgtYTEyZC00ZmIxLTgyYTMtYjBhMWYwODk3ZWVjIn0.K3hLlvLDHnaZLyMxGisB2mlbQiacHJZeGKu8et9tqCM"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:24.314078"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.318347"], ["updated_at", "2024-12-16 16:54:24.318347"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 191ms (Views: 0.1ms | ActiveRecord: 2.7ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "d54e2d65-7269-4848-af47-9b7f6761dca4"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 178ms (Views: 0.4ms | ActiveRecord: 2.6ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.684262"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "be1a4f1a-77de-43cf-8cf3-ba9069856f8f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc2NCwianRpIjoiYmUxYTRmMWEtNzdkZS00M2NmLThjZjMtYmE5MDY5ODU2ZjhmIn0.fy8jCqidLg_Qv-N_cvBCI4ciPQk10XpxbDYnB8barRA"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:24.682361"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.686221"], ["updated_at", "2024-12-16 16:54:24.686221"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.690022"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "052ed2c2-7e1d-4a84-9bc8-3b6dfd17d220"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY2NCwianRpIjoiMDUyZWQyYzItN2UxZC00YTg0LTliYzgtM2I2ZGZkMTdkMjIwIn0.X6QJRPGAvKyNF7hDlaS87QgAjRB2JOMSgSyoH8QDeQg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:24.688882"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.692133"], ["updated_at", "2024-12-16 16:54:24.692133"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 179ms (Views: 0.1ms | ActiveRecord: 1.4ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "be1a4f1a-77de-43cf-8cf3-ba9069856f8f"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:54:24.707043"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 19ms (Views: 0.5ms | ActiveRecord: 1.6ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.896005"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "507a38f5-11db-4c17-877b-81523fd834b3"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc2NCwianRpIjoiNTA3YTM4ZjUtMTFkYi00YzE3LTg3N2ItODE1MjNmZDgzNGIzIn0.E_9FMYN37bfaWB2GEQzX69GNdC419sw9qpTeGOsE6xg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:24.892442"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.899808"], ["updated_at", "2024-12-16 16:54:24.899808"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:24.904383"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "56667534-84ea-4d57-8479-b6a9fb5bb0f0"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY2NCwianRpIjoiNTY2Njc1MzQtODRlYS00ZDU3LTg0NzktYjZhOWZiNWJiMGYwIn0.seBs6nyModlRGQ96lun7tkdHPR4Ah-_yvvRjS8FDGxw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:24.902357"], ["revoked", false], ["created_at", "2024-12-16 16:54:24.907975"], ["updated_at", "2024-12-16 16:54:24.907975"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 185ms (Views: 0.2ms | ActiveRecord: 1.7ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-16 16:54:24.924242"], ["updated_at", "2024-12-16 16:54:24.924242"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.1ms | ActiveRecord: 0.8ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:24 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:25.104818"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "3708efdd-be22-44b3-802d-7b99e4cb0503"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc2NSwianRpIjoiMzcwOGVmZGQtYmUyMi00NGIzLTgwMmQtN2I5OWU0Y2IwNTAzIn0.uZKEakRSVfXN0UxSSOgD7J_K2PEUu3kgMte3HoXc1A4"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:25.103219"], ["revoked", false], ["created_at", "2024-12-16 16:54:25.109095"], ["updated_at", "2024-12-16 16:54:25.109095"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:25.112198"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "fe04a1ed-dd77-4279-be33-c4d51ade23cc"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY2NSwianRpIjoiZmUwNGExZWQtZGQ3Ny00Mjc5LWJlMzMtYzRkNTFhZGUyM2NjIn0.MGtc44Xa3cBEgHaCaw13jWLmF_TL69deP2N0MH4UGjY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:25.112039"], ["revoked", false], ["created_at", "2024-12-16 16:54:25.113625"], ["updated_at", "2024-12-16 16:54:25.113625"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 180ms (Views: 0.5ms | ActiveRecord: 2.2ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:54:25 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 13ms (Views: 1.0ms | ActiveRecord: 0.5ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$BKnajLbLM1bxaMdM0XzkL.QRZu2W42j47EGgv0pHq78BFtr8gop6.', '2024-12-16 16:54:39.970352', '2024-12-16 16:54:39.970352')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.7ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_password_with_space
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:40 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:40.353945"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "d9e4b55a-9ae8-4b9d-a3d3-174cf87e87cf"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc4MCwianRpIjoiZDllNGI1NWEtOWFlOC00YjlkLWEzZDMtMTc0Y2Y4N2U4N2NmIn0.M5OLwUoraAp-EiQpnC1TLYEdfFOc-KMOTgVb4b7q8vk"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:40.337360"], ["revoked", false], ["created_at", "2024-12-16 16:54:40.364151"], ["updated_at", "2024-12-16 16:54:40.364151"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:40.375110"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "908c2daf-f0fc-4a9c-9253-7d7878417cd2"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY4MCwianRpIjoiOTA4YzJkYWYtZjBmYy00YTljLTkyNTMtN2Q3ODc4NDE3Y2QyIn0.UpW9lo54T9WoVYI5J3cSlR_lyLC67Ibw4z956CetALQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:40.374096"], ["revoked", false], ["created_at", "2024-12-16 16:54:40.377610"], ["updated_at", "2024-12-16 16:54:40.377610"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 235ms (Views: 0.3ms | ActiveRecord: 7.5ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/reset_password" for 127.0.0.1 at 2024-12-16 16:54:40 -0300
Processing by RegistrationsController#reset_password as HTML
  Parameters: {"old_password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "confirm_new_password"=>"[FILTERED]"}
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "d9e4b55a-9ae8-4b9d-a3d3-174cf87e87cf"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 191ms (Views: 0.2ms | ActiveRecord: 2.4ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
RegistrationsControllerTest: test_should_update_user
----------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:40 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:40.779353"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "8705f5f7-f6b7-41fe-b7be-2deba95e967f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc4MCwianRpIjoiODcwNWY1ZjctZjZiNy00MWZlLWI3YmUtMmRlYmE5NWU5NjdmIn0.V-ScVXdLXQxKqfBZWB_gen9odsTMZy8N_H1lCcC6J8w"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:40.777824"], ["revoked", false], ["created_at", "2024-12-16 16:54:40.783759"], ["updated_at", "2024-12-16 16:54:40.783759"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:40.787806"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "e1a74891-1bc7-4998-90f6-378b823815fb"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY4MCwianRpIjoiZTFhNzQ4OTEtMWJjNy00OTk4LTkwZjYtMzc4YjgyMzgxNWZiIn0.OumxC1i2mSkbCXz4OGylDOk1WIpB_Hd2u05TmDlf9Mw"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:40.787354"], ["revoked", false], ["created_at", "2024-12-16 16:54:40.790363"], ["updated_at", "2024-12-16 16:54:40.790363"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 187ms (Views: 0.2ms | ActiveRecord: 2.0ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:54:40 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"UpdatedNickname", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "8705f5f7-f6b7-41fe-b7be-2deba95e967f"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", "UpdatedNickname"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "nickname" = $1, "email" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["nickname", "UpdatedNickname"], ["email", "[FILTERED]"], ["updated_at", "2024-12-16 16:54:40.809532"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 1.4ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_create_user_with_invalid_params
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:40 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.4ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:40.993619"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "f3c89702-3e7b-4dd6-9cef-084da3c70e23"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc4MCwianRpIjoiZjNjODk3MDItM2U3Yi00ZGQ2LTljZWYtMDg0ZGEzYzcwZTIzIn0.2TDEOxVoCul--GBxlDzLBYs1SLMA0gZRIR8vrrTncSU"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:40.992417"], ["revoked", false], ["created_at", "2024-12-16 16:54:40.996031"], ["updated_at", "2024-12-16 16:54:40.996031"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.000432"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "1a5afd9d-7d99-42c2-ba51-a5d3894d026b"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY4MCwianRpIjoiMWE1YWZkOWQtN2Q5OS00MmMyLWJhNTEtYTVkMzg5NGQwMjZiIn0.6BFeKgRkFx4Z29nm4T3pImhvn9GLh4Waran7GjrGq3U"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:40.999137"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.003691"], ["updated_at", "2024-12-16 16:54:41.003691"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 180ms (Views: 0.2ms | ActiveRecord: 1.8ms (5 queries, 0 cached) | GC: 0.0ms)
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 0.3ms | ActiveRecord: 0.8ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
RegistrationsControllerTest: test_should_not_update_user_with_invalid_data
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.195204"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.7ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "847f050e-13f3-458f-a89c-6cb3dc50f141"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc4MSwianRpIjoiODQ3ZjA1MGUtMTNmMy00NThmLWE4OWMtNmNiM2RjNTBmMTQxIn0.d29F55nOV3UxwlQcx7ki9YNhuitJjo4ZyFIhFIrA3Bs"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:41.191792"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.198583"], ["updated_at", "2024-12-16 16:54:41.198583"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.205850"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "4debbb91-c19c-44e8-8f36-fc354e8446b6"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY4MSwianRpIjoiNGRlYmJiOTEtYzE5Yy00NGU4LThmMzYtZmMzNTRlODQ0NmI2In0.DCFYY8-9bYWceCRGZKIADGWiJTr2BDWK-1J1QmKwAL4"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:41.202463"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.210109"], ["updated_at", "2024-12-16 16:54:41.210109"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 187ms (Views: 0.2ms | ActiveRecord: 2.0ms (5 queries, 0 cached) | GC: 0.0ms)
Started PUT "/backend/v1/register/update" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by RegistrationsController#update as HTML
  Parameters: {"nickname"=>"", "email"=>"[FILTERED]"}
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "847f050e-13f3-458f-a89c-6cb3dc50f141"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["nickname", ""], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 13ms (Views: 0.1ms | ActiveRecord: 0.7ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
RegistrationsControllerTest: test_should_create_user_with_valid_params
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.408154"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "bc95a5bf-1d5d-4357-bc4c-6ccf71f9ba87"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc4MSwianRpIjoiYmM5NWE1YmYtMWQ1ZC00MzU3LWJjNGMtNmNjZjcxZjliYTg3In0.KlfTRbiDK7ufURuTSNWbs35xAqZW0947MbCOdx-0yNc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:41.406317"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.413223"], ["updated_at", "2024-12-16 16:54:41.413223"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.418280"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "66049454-0f47-42e3-93e2-25e75ce16a55"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY4MSwianRpIjoiNjYwNDk0NTQtMGY0Ny00MmUzLTkzZTItMjVlNzVjZTE2YTU1In0.XBVQM1OLdhstRe-dwuUi1CP5sSON_D2vlN2c8ueDtYg"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:41.418100"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.419829"], ["updated_at", "2024-12-16 16:54:41.419829"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 184ms (Views: 0.6ms | ActiveRecord: 2.5ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/backend/v1/register" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by RegistrationsController#create as HTML
  Parameters: {"nickname"=>"TestUser", "email"=>"[FILTERED]", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "TestUser"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("nickname", "email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["nickname", "TestUser"], ["email", "[FILTERED]"], ["password_digest", "[FILTERED]"], ["created_at", "2024-12-16 16:54:41.437475"], ["updated_at", "2024-12-16 16:54:41.437475"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.8ms | ActiveRecord: 1.1ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_get_about_me
---------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.618143"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "ab87c58c-f8f0-4ae8-a057-5f2a130b1e22"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc4MSwianRpIjoiYWI4N2M1OGMtZjhmMC00YWU4LWEwNTctNWYyYTEzMGIxZTIyIn0.XW9w56PyRhvQVU5yMHiZ0W2F6YidSkkgLdHE877yHGQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:41.617664"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.620406"], ["updated_at", "2024-12-16 16:54:41.620406"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.621582"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "5abeec06-54bd-4937-943c-caab626405b6"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY4MSwianRpIjoiNWFiZWVjMDYtNTRiZC00OTM3LTk0M2MtY2FhYjYyNjQwNWI2In0.obA6qNRqyMc3-WpztFgFoytLOVu2z36m7rBQ1-413xI"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:41.621435"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.622538"], ["updated_at", "2024-12-16 16:54:41.622538"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 176ms (Views: 0.1ms | ActiveRecord: 1.1ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/register/me" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by UsersController#about_me as HTML
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "ab87c58c-f8f0-4ae8-a057-5f2a130b1e22"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 0.3ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
HomeControllerTest: test_should_get_hello
-----------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.805575"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.6ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "22130b1e-a106-491a-a543-128d69a7d2dc"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM3OTc4MSwianRpIjoiMjIxMzBiMWUtYTEwNi00OTFhLWE1NDMtMTI4ZDY5YTdkMmRjIn0.OC5-jQZSUROJHsLnNvBU9LwUe1N2KNedgU9APod0bRY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:09:41.804425"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.807290"], ["updated_at", "2024-12-16 16:54:41.807290"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.808787"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "2243cb79-37f0-4215-be50-b9437780255d"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MTY4MSwianRpIjoiMjI0M2NiNzktMzdmMC00MjE1LWJlNTAtYjk0Mzc3ODAyNTVkIn0.DqFMZfW8JwT3T2vdyAZLYJzi69u56uuyhbscwB-bPzc"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 16:54:41.808598"], ["revoked", false], ["created_at", "2024-12-16 16:54:41.811426"], ["updated_at", "2024-12-16 16:54:41.811426"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 174ms (Views: 0.3ms | ActiveRecord: 1.6ms (5 queries, 0 cached) | GC: 0.0ms)
Started GET "/backend/v1/hello" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by HomeController#hello as HTML
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."jti" = $1 AND "tokens"."token_type" = $2 LIMIT $3[0m  [["jti", "22130b1e-a106-491a-a543-128d69a7d2dc"], ["token_type", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.824533"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login/refresh" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#refresh as HTML
Completed 401 Unauthorized in 1ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.838989"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login/refresh" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#refresh as HTML
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.847791"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"devcurumin@gmail.com", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:54:41.859309"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:54:41 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"devcurumin@gmail.com", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$Syv24RQuXNcntixEjEaCluBr5h3mmYIcIPgmD9pVV6N3VL5l.IQcu', '2024-12-16 16:56:40.580425', '2024-12-16 16:56:40.580425')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.9ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:56:40.741294"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login/refresh" for 127.0.0.1 at 2024-12-16 16:56:40 -0300
Processing by SessionsController#refresh as HTML
Completed 401 Unauthorized in 10ms (Views: 0.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
SessionsControllerTest: test_should_not_refresh_token_with_invalid_refresh_token
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.1ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:56:40.799304"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login/refresh" for 127.0.0.1 at 2024-12-16 16:56:40 -0300
Processing by SessionsController#refresh as HTML
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
SessionsControllerTest: test_should_not_log_in_user_with_invalid_credentials
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:56:40.816957"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:56:40 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"devcurumin@gmail.com", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
SessionsControllerTest: test_should_log_in_user_with_valid_credentials
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 16:56:40.829416"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 16:56:40 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"devcurumin@gmail.com", "password"=>"[FILTERED]"}
Completed 422 Unprocessable Content in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (3.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$H3uGIT9SrJER1C6AT4k.jesbDKnIy1im4X23iIwBe80yFs7Qa.q5S', '2024-12-16 17:09:53.713812', '2024-12-16 17:09:53.713812')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (4.4ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 17:09:53 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:09:54.091137"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.4ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "803d6a38-4e5e-482a-bd7a-dc32df90854f"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM4MDY5NCwianRpIjoiODAzZDZhMzgtNGU1ZS00ODJhLWJkN2EtZGMzMmRmOTA4NTRmIn0.HZ4W5UEspFvIEBlvM1x1XG38l9f2sFqrstTI0i_ImZA"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:24:54.076241"], ["revoked", false], ["created_at", "2024-12-16 17:09:54.100618"], ["updated_at", "2024-12-16 17:09:54.100618"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:09:54.111048"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "f60c052a-c9ee-4cd8-aaf7-55794f327fc0"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MjU5NCwianRpIjoiZjYwYzA1MmEtYzllZS00Y2Q4LWFhZjctNTU3OTRmMzI3ZmMwIn0.5FJlZFixbw1GRsmUxULMyqKtz135FBOUVzdBCd7S21I"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 17:09:54.110293"], ["revoked", false], ["created_at", "2024-12-16 17:09:54.113719"], ["updated_at", "2024-12-16 17:09:54.113719"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 234ms (Views: 0.3ms | ActiveRecord: 8.0ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$YyhsaQaD/8ZKruNxb.dAyOPGhNozfNSx60Topc8yT8fmnYQOMnbFW', '2024-12-16 17:15:46.565420', '2024-12-16 17:15:46.565420')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.7ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 17:15:46 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.5ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:15:46.947283"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "11088899-c217-489a-91d0-6fdc1bc13932"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM4MTA0NiwianRpIjoiMTEwODg4OTktYzIxNy00ODlhLTkxZDAtNmZkYzFiYzEzOTMyIn0.yvJ0AUAY9u3AqSxjCWoemHb4hhhSaOah2KfROVm0Z2g"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:30:46.933828"], ["revoked", false], ["created_at", "2024-12-16 17:15:46.956067"], ["updated_at", "2024-12-16 17:15:46.956067"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:15:46.965977"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "03f31f20-1973-4e8b-ad8b-4762b46bfc22"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1Mjk0NiwianRpIjoiMDNmMzFmMjAtMTk3My00ZThiLWFkOGItNDc2MmI0NmJmYzIyIn0.t0R0jKqvqjAUv0-xDpuMkQP38QX-pbdjLOgq18eEGoU"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 17:15:46.965238"], ["revoked", false], ["created_at", "2024-12-16 17:15:46.968393"], ["updated_at", "2024-12-16 17:15:46.968393"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 231ms (Views: 0.3ms | ActiveRecord: 7.2ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$9qIipbtgKJ.WPs4V64DvBOPpt7L5YOh0CiKoMoqwefSc6DTXjCkna', '2024-12-16 17:20:14.389672', '2024-12-16 17:20:14.389672')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.9ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (0.6ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:20:14.558933"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 17:20:14 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:20:14.775680"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.3ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "8e57c6c5-c9a5-4b11-94b9-abae49fb8762"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM4MTMxNCwianRpIjoiOGU1N2M2YzUtYzlhNS00YjExLTk0YjktYWJhZTQ5ZmI4NzYyIn0.O8n8Y9zK2pABldxByFGIt9UGIijQzmxNqkcOJGolXvY"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:35:14.774709"], ["revoked", false], ["created_at", "2024-12-16 17:20:14.785494"], ["updated_at", "2024-12-16 17:20:14.785494"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:20:14.795976"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.5ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "e2da7096-d121-465e-b574-a4b35785cfbf"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MzIxNCwianRpIjoiZTJkYTcwOTYtZDEyMS00NjVlLWI1NzQtYTRiMzU3ODVjZmJmIn0.V2o1wrYfRl-J__cKbkPYRb8Q6S83K8JmHCQnGDjb6ns"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 17:20:14.795305"], ["revoked", false], ["created_at", "2024-12-16 17:20:14.800101"], ["updated_at", "2024-12-16 17:20:14.800101"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 218ms (Views: 0.4ms | ActiveRecord: 4.8ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
[dotenv] Set [36mMAIL_USER[0m, [36mMAIL_PASS[0m, [36mMAIL_ADDR[0m, [36mMAIL_HOST[0m, [36mMAIL_PORT[0m, [36mDB_NAME[0m, [36mDB_USER[0m, [36mDB_PASS[0m, [36mDB_HOST[0m, [36mDB_PORT[0m, [36mEFIPAY_CLIENT_ID[0m, [36mEFIPAY_CLIENT_SECRET[0m, [36mEFIPAY_CERTIFICATE[0m, [36mEFIPAY_PIXKEY[0m, and [36mEFIPAY_API_URL[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "tokens" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "tokens";
DELETE FROM "users";
INSERT INTO "users" ("id", "nickname", "email", "password_digest", "created_at", "updated_at") VALUES (980190962, 'DevCurumin', 'devcurumin@gmail.com', '$2a$12$1Txrz92nGsZesUYIrxVOSe209xzwBtQSoEI3Z7xg2Lwn64d/LtQDC', '2024-12-16 17:26:28.945159', '2024-12-16 17:26:28.945159')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "tokens" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
SessionsControllerTest: test_should_refresh_token_with_valid_refresh_token
--------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mToken Load (1.0ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:26:29.106401"], ["LIMIT", 1]]
Started POST "/backend/v1/auth/login" for 127.0.0.1 at 2024-12-16 17:26:29 -0300
Processing by SessionsController#create as HTML
  Parameters: {"login"=>"DevCurumin", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."nickname" = $1 LIMIT $2[0m  [["nickname", "DevCurumin"], ["LIMIT", 1]]
  [1m[36mToken Load (0.3ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:26:29.328592"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (1.2ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "05889c20-488b-4354-b85c-d145b9c97277"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDM4MTY4OSwianRpIjoiMDU4ODljMjAtNDg4Yi00MzU0LWI4NWMtZDE0NWI5Yzk3Mjc3In0.-JQZM2ENx69P0aeb_yhY8170mcmUpRnzgYdCZevOfvQ"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-16 17:41:29.327098"], ["revoked", false], ["created_at", "2024-12-16 17:26:29.338285"], ["updated_at", "2024-12-16 17:26:29.338285"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mToken Load (0.2ms)[0m  [1m[34mSELECT "tokens".* FROM "tokens" WHERE "tokens"."user_id" = $1 AND "tokens"."token_type" = $2 AND "tokens"."revoked" = $3 AND (expires_at > $4) ORDER BY "tokens"."id" ASC LIMIT $5[0m  [["user_id", 980190962], ["token_type", "[FILTERED]"], ["revoked", false], [nil, "2024-12-16 17:26:29.350353"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mToken Create (0.9ms)[0m  [1m[32mINSERT INTO "tokens" ("user_id", "jti", "jwt", "token_type", "expires_at", "revoked", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["user_id", 980190962], ["jti", "4b9d1573-7ac6-42e7-8e02-2b148dc199b2"], ["jwt", "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo5ODAxOTA5NjIsImV4cCI6MTczNDU1MzU4OSwianRpIjoiNGI5ZDE1NzMtN2FjNi00MmU3LThlMDItMmIxNDhkYzE5OWIyIn0.TsMlizXuejN7CjYmHgYSEHv5zeBdkkUMRxhfnB1ji1A"], ["token_type", "[FILTERED]"], ["expires_at", "2024-12-18 17:26:29.349394"], ["revoked", false], ["created_at", "2024-12-16 17:26:29.355710"], ["updated_at", "2024-12-16 17:26:29.355710"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 221ms (Views: 0.3ms | ActiveRecord: 3.6ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
